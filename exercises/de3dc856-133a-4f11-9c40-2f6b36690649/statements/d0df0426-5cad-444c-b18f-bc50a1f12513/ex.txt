Improve the existing spell casting algorithm to make it more efficient using advanced data structures.